from agents.base_agent import BaseAgent

class WebPentester(BaseAgent):
    """Specialist for web-based reconnaissance and exploitation."""
    
    def __init__(self):
        super().__init__("Web Pentester", "Logic for Burp, ZAP, SQLMap, Nikto, and web vulns.")

    def execute(self, task):
        # 1. ANALYZE TASK
        prompt = f"""
        Task: {task}
        
        Available Tools: sqlmap, nikto, gobuster, ffuf, curl.
        Determine the best command to run.
        Output ONLY the command or [COMPLETE] if done.
        """
        decision = self.reason(prompt)
        
        if "[COMPLETE]" in decision.upper():
            return {"status": "complete", "summary": decision}

        # 2. RUN COMMAND
        cmd = decision.strip()
        result = self.run_cmd(cmd)
        
        # 3. SUMMARIZE
        summary = self.summarize_result(cmd, result)
        return {
            "status": "success" if result.get("code") == 0 else "failed",
            "cmd": cmd,
            "stdout": result.get("stdout"),
            "stderr": result.get("stderr"),
            "summary": summary
        }
